(()=>{var e={528:(e,n)=>{n.info=e=>{console.log(`%s INFO`,(new Date).toGMTString().replace(/.*, /,""),e.toString().replace(/\x1B\[[0-9;]*[JKmsu]/g,""))};n.warn=e=>{console.warn(`%s WARN`,(new Date).toGMTString().replace(/.*, /,""),e.toString().replace(/\x1B\[[0-9;]*[JKmsu]/g,""))};n.error=e=>{console.error(`%s ERROR`,(new Date).toGMTString().replace(/.*, /,""),e.toString().replace(/\x1B\[[0-9;]*[JKmsu]/g,""))}},608:(e,n,r)=>{const{spawnSync:t}=r(129);function info(e){r(528).info(`utils.js - ${e}`)}const executeSyncCmd=(e,n,r,o)=>{const i={env:{...process.env,...o},shell:true};if(typeof i?.env?.DOCKER_BUILDKIT!=="undefined"){info(`DOCKER_BUILDKIT is set to ${i.env.DOCKER_BUILDKIT}`)}info(`Executing command: ${e} ${n.toString().replace(/,/g," ").replace(/[0-9a-zA-Z]{200,}(==)?/g,"**TOKEN**")} with envs: ${JSON.stringify(i)}`);const s=t(e,n,i);if(s.status!==0){if(r){throw new Error(r)}throw new Error(s.stderr.toString())}info(`EXIT_CODE: ${s.status}, STDOUT: ${s.stdout.toString()}`);return s.stdout.toString()};const sortByKey=(e,n)=>e.sort((function(e,r){var t=e[n];var o=r[n];return t<o?-1:t>o?1:0}));n.executeSyncCmd=executeSyncCmd;n.sortByKey=sortByKey},129:e=>{"use strict";e.exports=require("child_process")}};var n={};function __nccwpck_require__(r){var t=n[r];if(t!==undefined){return t.exports}var o=n[r]={exports:{}};var i=true;try{e[r](o,o.exports,__nccwpck_require__);i=false}finally{if(i)delete n[r]}return o.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r={};(()=>{var e=r;const{executeSyncCmd:n}=__nccwpck_require__(608);const filterEmpty=e=>e;function info(e){__nccwpck_require__(528).info(`cleanup.js - ${e}`)}const cleanup=()=>{info("================ Initializing docker cleanup ================");info("Listing running containers...");const e=n("docker",["ps","-aq"]).split("\n").filter(filterEmpty);info(`Total Running containers: ${e.length}`);for(let r of e){info(`Stopping container ${r}`);n("docker",["stop",r]);info(`Removing container ${r}`);n("docker",["rm",r])}if(process.env.GITHUB_RUNNER_LABELS){let e="docker system prune -f";let n="docker rmi $(docker images | egrep 'ecr|olxbr' | awk '{print $3}')";info("Found Self-hosted Runner. Clean all the mess to avoid Ephemeral Storage on k8s...");info("Docker System prune: "+__nccwpck_require__(129).spawnSync(e,{shell:true}).stdout.toString());info("Docker RMI: "+__nccwpck_require__(129).spawnSync(n,{shell:true}).stdout.toString())}else{info("No need to clean. Not Self-hosted")}info("================ Finished docker cleanup ================")};cleanup();e.cleanup=cleanup})();module.exports=r})();