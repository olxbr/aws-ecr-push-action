{"Version":"2008-10-17","Statement":[{"Sid":"AllowPushPull","Effect":"Allow","Principal":{"AWS":["arn:aws:iam::1234:root","arn:aws:iam::4321:root"]},"Action":["ecr:GetDownloadUrlForLayer","ecr:BatchGetImage","ecr:BatchCheckLayerAvailability","ecr:PutImage","ecr:InitiateLayerUpload","ecr:UploadLayerPart","ecr:CompleteLayerUpload"]},{"Sid":"CrossAccountPermission","Effect":"Allow","Action":["ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Principal":{"AWS":["arn:aws:iam::1234:root","arn:aws:iam::4321:root"]}},{"Sid":"LambdaECRImageCrossAccountRetrievalPolicy","Effect":"Allow","Action":["ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Principal":{"Service":"lambda.amazonaws.com"},"Condition":{"StringLike":{"aws:sourceARN":["arn:aws:lambda:us-east-1:1234:function:*","arn:aws:lambda:us-east-1:4321:function:*"]}}},{"Sid":"AllowSecImageScanning","Effect":"Allow","Principal":{"AWS":["arn:aws:iam::1234:root","arn:aws:iam::4321:root"]},"Action":["ecr:DescribeRepositories","ecr:PutImageScanningConfiguration","ecr:BatchGetRepositoryScanningConfiguration","ecr:StartImageScan","ecr:DescribeImageScanFindings","ecr:PutRegistryScanningConfiguration","ecr:GetRegistryScanningConfiguration"],"Condition":{"StringLike":{"aws:sourceARN":["arn:aws:iam::1234:role/*security-role","arn:aws:iam::4321:role/*security-role"]}}},{"Sid":"ElasticBeanstalkApplicationInstance","Effect":"Allow","Principal":{"AWS":["arn:aws:iam::1234:root","arn:aws:iam::4321:root"]},"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Condition":{"StringLike":{"aws:sourceARN":["arn:aws:iam::1234:role/aws-elasticbeanstalk-service-role","arn:aws:iam::4321:role/aws-elasticbeanstalk-service-role"]}}}]}
