{
   "Version":"2008-10-17",
   "Statement":[
      {
         "Sid":"AllowPushPull",
         "Effect":"Allow",
         "Principal":{
            "AWS":[
               "arn:aws:iam::undefined:root"
            ]
         },
         "Action":[
            "ecr:GetDownloadUrlForLayer",
            "ecr:BatchGetImage",
            "ecr:BatchCheckLayerAvailability",
            "ecr:PutImage",
            "ecr:InitiateLayerUpload",
            "ecr:UploadLayerPart",
            "ecr:CompleteLayerUpload"
         ]
      },
      {
         "Sid":"CrossAccountPermission",
         "Effect":"Allow",
         "Action":[
            "ecr:BatchGetImage",
            "ecr:GetDownloadUrlForLayer"
         ],
         "Principal":{
            "AWS":[
               "arn:aws:iam::undefined:root"
            ]
         }
      },
      {
         "Sid":"LambdaECRImageCrossAccountRetrievalPolicy",
         "Effect":"Allow",
         "Action":[
            "ecr:BatchGetImage",
            "ecr:GetDownloadUrlForLayer"
         ],
         "Principal":{
            "Service":"lambda.amazonaws.com"
         },
         "Condition":{
            "StringLike":{
               "aws:sourceARN":[
                  "arn:aws:lambda:us-east-1:undefined:function:*"
               ]
            }
         }
      },
      {
         "Sid":"AllowSecImageScanning",
         "Effect":"Allow",
         "Principal":{
            "AWS":[
               "arn:aws:iam::undefined:root"
            ]
         },
         "Action":[
            "ecr:DescribeRepositories",
            "ecr:PutImageScanningConfiguration",
            "ecr:BatchGetRepositoryScanningConfiguration",
            "ecr:StartImageScan",
            "ecr:DescribeImageScanFindings",
            "ecr:PutRegistryScanningConfiguration",
            "ecr:GetRegistryScanningConfiguration"
         ],
         "Condition":{
            "StringLike":{
               "aws:sourceARN":[
                  "arn:aws:iam::undefined:role/*security-role"
               ]
            }
         }
      },
      {
         "Sid":"ElasticBeanstalkApplicationInstance",
         "Effect":"Allow",
         "Principal":{
            "AWS":"arn:aws:iam::183337677225:role/aws-elasticbeanstalk-service-role"
         },
         "Action":[
            "ecr:GetDownloadUrlForLayer",
            "ecr:BatchGetImage",
            "ecr:BatchCheckLayerAvailability"
         ]
      }
   ]
}
